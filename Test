#Populate with the App Registration details and Tenant ID
$appid = ''
$tenantid = ''
$secretkey = ''
#appId     = $env:PSAppID
#appKey    = $env:PSTenantID
#secretKey = $env:PSSecretKey
$body =  @{
    Grant_Type    = "client_credentials"
    Scope         = "https://graph.microsoft.com/.default"
    Client_Id     = $appid
    Client_Secret = $secretkey
}
$connection = Invoke-RestMethod `
    -Uri https://login.microsoftonline.com/$tenantid/oauth2/v2.0/token `
    -Method POST `
    -Body $body
$graphApiToken = $connection.access_token
 
$targetParameter = (Get-Command Connect-MgGraph).Parameters['AccessToken']
 
if ($targetParameter.ParameterType -eq [securestring]){
  Connect-MgGraph -AccessToken ($graphApiToken |ConvertTo-SecureString -AsPlainText -Force)
}
else {
  Connect-MgGraph -AccessToken $graphApiToken
}



-----------------------------------
# Define the file path
$filePath = "C:\Temp\DeploymentRuleset.txt"

# Define the reference date
$referenceDate = Get-Date "08/13/2024"

# Check if the file exists
if (Test-Path $filePath) {
    # Get the Date Modified property of the file
    $fileModifiedDate = (Get-Item $filePath).LastWriteTime

    # Output the file's Date Modified and the reference date for debugging
    Write-Host "File Last Modified Date: $($fileModifiedDate)"
    Write-Host "Reference Date: $($referenceDate)"

    # Compare the file's Date Modified with the reference date
    if ($fileModifiedDate -le $referenceDate) {
        Write-Host "File is older."
    } else {
        Write-Host "File is newer."
    }
} else {
    Write-Host "File does not exist."
}
---------------------


# Function to get the system uptime
function Get-SystemUptime {
    $uptime = (Get-CimInstance Win32_OperatingSystem).LastBootUpTime
    $currentTime = Get-Date
    $uptimeSpan = $currentTime - $uptime
    Write-Output ("System Uptime: {0}" -f $uptimeSpan)
    Write-Output ("Last Reboot Time: {0}" -f $uptime)
}

# Call the function
Get-SystemUptime
